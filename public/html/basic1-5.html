<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript練習【ES6+モジュール編】</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <header>
        <h1>JavaScript</h1>
    </header>
    
    <main>
        <div class="container">
            <h2>JavaScript ES6+モジュール編</h2>
            <p>モダンなJavaScriptの機能とモジュールシステムを学習します。<br>
            実際のプロジェクトで使われる最新の機能を理解しましょう。</p>
            
            <section class="section">
                <h3>10. ES6モジュール（import/export）</h3>
                <p>モジュールを使ってコードを分割し、再利用可能にする方法を学びます。</p>
                <div class="code-block">
                    <pre><code>// math.js (エクスポート側)
export function add(a, b) {
    return a + b;
}

export function multiply(a, b) {
    return a * b;
}

export const PI = 3.14159;

// main.js (インポート側)
import { add, multiply, PI } from './math.js';
import * as MathUtils from './math.js';

console.log("加算:", add(5, 3));
console.log("乗算:", multiply(4, 7));
console.log("円周率:", PI);</code></pre>
                </div>
                <button class="btn" onclick="runModuleExample()">実行してみる</button>
                <div class="result" id="result-module"></div>
            </section>

            <section class="section">
                <h3>11. デフォルトエクスポート</h3>
                <p>モジュールのメイン機能をデフォルトエクスポートとして定義する方法を学びます。</p>
                <div class="code-block">
                    <pre><code>// calculator.js
export default class Calculator {
    add(a, b) { return a + b; }
    subtract(a, b) { return a - b; }
    multiply(a, b) { return a * b; }
    divide(a, b) { return b !== 0 ? a / b : 'エラー: ゼロ除算'; }
}

// 名前付きエクスポートも同時に可能
export const version = '1.0.0';

// main.js
import Calculator, { version } from './calculator.js';

const calc = new Calculator();
console.log("計算結果:", calc.add(10, 5));
console.log("バージョン:", version);</code></pre>
                </div>
                <button class="btn" onclick="runDefaultExportExample()">実行してみる</button>
                <div class="result" id="result-default-export"></div>
            </section>

            <section class="section">
                <h3>12. 動的インポート</h3>
                <p>必要な時にモジュールを動的に読み込む方法を学びます。</p>
                <div class="code-block">
                    <pre><code>// 動的インポートの例
async function loadModule() {
    try {
        // 条件に応じてモジュールを読み込み
        const condition = true;
        
        if (condition) {
            const module = await import('./math.js');
            console.log("動的読み込み成功");
            console.log("加算結果:", module.add(15, 25));
        }
    } catch (error) {
        console.error("モジュール読み込みエラー:", error);
    }
}

// 遅延読み込みの例
function lazyLoad() {
    import('./calculator.js')
        .then(module => {
            const Calculator = module.default;
            const calc = new Calculator();
            console.log("遅延読み込み:", calc.multiply(6, 7));
        })
        .catch(err => console.error(err));
}</code></pre>
                </div>
                <button class="btn" onclick="runDynamicImportExample()">実行してみる</button>
                <div class="result" id="result-dynamic-import"></div>
            </section>

            <section class="section">
                <h3>13. Optional Chaining（?.）</h3>
                <p>安全にオブジェクトのプロパティにアクセスする方法を学びます。</p>
                <div class="code-block">
                    <pre><code>const user = {
    name: "田中太郎",
    address: {
        city: "東京",
        zipCode: "100-0001"
    },
    hobbies: ["読書", "映画鑑賞"]
};

const userWithoutAddress = {
    name: "佐藤花子"
};

// 従来の方法（エラーが発生する可能性）
// console.log(userWithoutAddress.address.city); // エラー!

// Optional Chainingを使用（安全）
console.log("都市1:", user.address?.city);
console.log("都市2:", userWithoutAddress.address?.city);
console.log("趣味:", user.hobbies?.[0]);
console.log("メソッド:", user.getName?.());</code></pre>
                </div>
                <button class="btn" onclick="runOptionalChainingExample()">実行してみる</button>
                <div class="result" id="result-optional-chaining"></div>
            </section>

            <section class="section">
                <h3>14. Nullish Coalescing（??）</h3>
                <p>null や undefined の場合のデフォルト値を設定する方法を学びます。</p>
                <div class="code-block">
                    <pre><code>const config = {
    theme: null,
    timeout: 0,
    debug: false,
    apiUrl: undefined
};

// || 演算子の問題点
console.log("|| 演算子:");
console.log("テーマ:", config.theme || "デフォルト");
console.log("タイムアウト:", config.timeout || 5000); // 0が偽値として扱われる
console.log("デバッグ:", config.debug || true); // falseが偽値として扱われる

// ?? 演算子（Nullish Coalescing）
console.log("\n?? 演算子:");
console.log("テーマ:", config.theme ?? "デフォルト");
console.log("タイムアウト:", config.timeout ?? 5000); // 0はそのまま
console.log("デバッグ:", config.debug ?? true); // falseはそのまま
console.log("API URL:", config.apiUrl ?? "https://api.example.com");</code></pre>
                </div>
                <button class="btn" onclick="runNullishCoalescingExample()">実行してみる</button>
                <div class="result" id="result-nullish-coalescing"></div>
            </section>

            <section class="section">
                <h3>15. パッケージマネージャー（npm基礎）</h3>
                <p>npmを使ったパッケージ管理の基本概念を学びます。</p>
                <div class="code-block">
                    <pre><code>// package.json の例
{
  "name": "my-project",
  "version": "1.0.0",
  "description": "JavaScriptプロジェクトの例",
  "main": "index.js",
  "scripts": {
    "start": "node index.js",
    "test": "jest",
    "build": "webpack --mode production"
  },
  "dependencies": {
    "lodash": "^4.17.21",
    "axios": "^0.27.2"
  },
  "devDependencies": {
    "jest": "^28.1.0",
    "webpack": "^5.72.0"
  }
}

// パッケージの使用例
// import _ from 'lodash';
// import axios from 'axios';

console.log("npm コマンド例:");
console.log("npm install lodash    # パッケージをインストール");
console.log("npm install --save-dev jest  # 開発依存関係として追加");
console.log("npm run start         # スクリプトを実行");
console.log("npm update           # パッケージを更新");</code></pre>
                </div>
                <button class="btn" onclick="runNpmBasicsExample()">実行してみる</button>
                <div class="result" id="result-npm-basics"></div>
            </section>

            <div class="navigation">
                <a href="basic1.html" class="btn btn-secondary">← 基礎編に戻る</a>
                <a href="../index.html" class="btn btn-secondary">ホームに戻る</a>
                <a href="basic2.html" class="btn">応用編へ →</a>
            </div>
        </div>
    </main>

    <script src="../js/basic1-5.js"></script>
</body>
</html>
